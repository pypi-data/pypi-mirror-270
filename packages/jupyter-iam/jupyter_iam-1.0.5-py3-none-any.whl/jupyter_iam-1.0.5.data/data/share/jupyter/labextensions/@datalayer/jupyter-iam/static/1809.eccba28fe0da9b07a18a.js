"use strict";(self.webpackChunk_datalayer_jupyter_iam=self.webpackChunk_datalayer_jupyter_iam||[]).push([[1809],{31809:(e,a,r)=>{r.r(a),r.d(a,{ANONYMOUS_TOKEN:()=>C.q$,ANONYMOUS_USER:()=>C.aK,BackdropProvider:()=>m,DEFAULT_AVATAR_URL:()=>s.jz,DatalayerIdentity:()=>o.q,IJupyterIAM:()=>y.IJupyterIAM,IdentityView:()=>s.tO,JoinConfirm:()=>E,JoinForm:()=>F,JoinWelcome:()=>q,LoginForm:()=>O,Logout:()=>W,NewPasswordConfirm:()=>J,NewPasswordForm:()=>B,NewPasswordWelcome:()=>M,PermissionsView:()=>s.i6,UserManager:()=>n.w,dbToUser:()=>C.b0,jpIAMStore:()=>k.Ck,toColor:()=>s.p9,useApi:()=>i.h,useBackdrop:()=>p,useNavigate:()=>v.s,useStore:()=>k.oR,useToast:()=>Z});var s=r(89381),o=r(4833),n=r(69371),i=r(57306),t=r(74512),l=r(66029),d=r(55990);const c=r.n(d)().div`
  position: fixed;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.3);
  height: 100vh;
  width: 100vw;
  right: 0;
  top: 0;
  z-index: 1000000000;
`,h=function({open:e,element:a}){return e?(0,t.jsx)(c,{children:a}):(0,t.jsx)(t.Fragment,{})},u=(0,l.createContext)({openBackdrop:e=>{},closeBackdrop:()=>{}}),m=({children:e})=>{const[a,r]=(0,l.useState)(!1),[s,o]=(0,l.useState)();return(0,t.jsxs)(u.Provider,{value:{openBackdrop:e=>{o(e),r(!0)},closeBackdrop:()=>{o(void 0),r(!1)}},children:[(0,t.jsx)(h,{open:a,element:s}),e]})};function p(){return(0,l.useContext)(u)}var v=r(20948),x=r(37756),j=r(33078),w=r(11e3);const g=w.toast.POSITION.TOP_CENTER,{insideJupyterLab:f}=(0,j.loadJupyterConfig)({}),Z=()=>({enqueueToast:(e,a)=>{switch(a.variant){case"info":f?x.Notification.info(e,{autoClose:5e3}):w.toast.info(e,{position:g});break;case"success":f?x.Notification.success(e,{autoClose:5e3}):w.toast.success(e,{position:g});break;case"warning":f?x.Notification.warning(e,{autoClose:5e3}):w.toast.warning(e,{position:g});break;case"error":f?x.Notification.error(e,{autoClose:5e3}):w.toast.error(e,{position:g})}}});var y=r(90278),C=r(53761),k=r(83513),b=r(12221),L=r(54915),R=r(32126),N=r(45455),S=r(97478),T=r(28977);const Y=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,A=(e,a)=>e.length>=a,E=e=>{const{loginRoute:a,joinWelcomeRoute:r}=e,{iamServerURL:s}=(0,k.ZP)(),o=(0,v.s)(),{apiRequest:n}=(0,i.h)(),{enqueueToast:d}=Z(),[c,h]=(0,l.useState)(!1),[u,m]=(0,l.useState)({handle:void 0,token:void 0}),[p,x]=(0,l.useState)({handle:void 0,token:void 0});return(0,l.useEffect)((()=>{x({...p,handle:void 0===u.handle?void 0:A(u.handle,1)?"success":"error",token:void 0===u.token?void 0:A(u.token,1)?"success":"error"})}),[u]),(0,t.jsxs)(b.X,{containerWidth:"medium",padding:"normal",sx:{overflow:"visible",minHeight:"calc(100vh - 45px)"},children:[(0,t.jsx)(b.X.Header,{children:(0,t.jsx)(L.Z,{children:"Activate Datalayer"})}),(0,t.jsx)(b.X.Content,{children:(0,t.jsx)(R.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,t.jsxs)(R.Z,{sx:{label:{marginTop:2}},children:[(0,t.jsx)(R.Z,{children:(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your handle"}),(0,t.jsx)(S.Z,{autoFocus:!0,value:u.handle,onChange:e=>{m((a=>({...a,handle:e.target.value})))}}),"error"===p.handle&&(0,t.jsx)(N.Z.Validation,{variant:p.handle,children:"Your handle must have more than 1 character."})]})}),(0,t.jsx)(R.Z,{children:(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your activation code (check your mail)"}),(0,t.jsx)(S.Z,{type:"email",value:u.token,onChange:e=>{m((a=>({...a,token:e.target.value})))}}),"error"===p.token&&(0,t.jsx)(N.Z.Validation,{variant:p.token,children:"Your activation code is too small."})]})}),(0,t.jsx)(R.Z,{sx:{display:"flex"},mt:2,children:(0,t.jsx)(T.r,{variant:"primary",type:"submit",disabled:c||"success"!==p.handle||"success"!==p.token,onClick:async()=>{c||(h(!0),n({url:`${s}/api/iam/v1/join/confirm/${u.handle}/${u.token}`,method:"GET"}).then((e=>{e.success?o(r):d(e.message,{variant:"error"})})).catch((e=>{console.error(e),d("Application Error.",{variant:"error"}),o(a)})))},children:c?"Activating...":"Activate"})})]})})})]})},F=e=>{const{joinConfirmRoute:a}=e,{iamServerURL:r}=(0,k.ZP)(),{apiRequest:s}=(0,i.h)(),{enqueueToast:o}=Z(),n=(0,v.s)(),[d,c]=(0,l.useState)(!1),[h,u]=(0,l.useState)({handle:void 0,email:void 0,firstName:void 0,lastName:void 0,password:void 0,passwordConfirm:void 0}),[m,p]=(0,l.useState)({handle:void 0,email:void 0,firstName:void 0,lastName:void 0,password:void 0,passwordConfirm:void 0});return(0,l.useEffect)((()=>{var e;p({...m,handle:void 0===h.handle?void 0:A(h.handle,1)?"success":"error",email:void 0===h.email?void 0:(e=h.email,Y.test(e)?"success":"error"),firstName:void 0===h.firstName?void 0:A(h.firstName,1)?"success":"error",lastName:void 0===h.lastName?void 0:A(h.lastName,1)?"success":"error",password:void 0===h.password?void 0:A(h.password,5)?"success":"error",passwordConfirm:void 0===h.passwordConfirm?void 0:A(h.passwordConfirm,5)?"success":"error"})}),[h]),(0,t.jsxs)(b.X,{containerWidth:"medium",padding:"normal",sx:{overflow:"visible",minHeight:"calc(100vh - 45px)"},children:[(0,t.jsx)(b.X.Header,{children:(0,t.jsx)(L.Z,{children:"Join Datalayer"})}),(0,t.jsx)(b.X.Content,{children:(0,t.jsx)(R.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,t.jsxs)(R.Z,{sx:{label:{marginTop:2}},children:[(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your handle"}),(0,t.jsx)(S.Z,{autoFocus:!0,value:h.handle,onChange:e=>{u((a=>({...a,handle:e.target.value})))}}),"error"===m.handle&&(0,t.jsx)(N.Z.Validation,{variant:m.handle,children:"Your handle must have more than 1 character."})]}),(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your email"}),(0,t.jsx)(S.Z,{type:"email",value:h.email,onChange:e=>{u((a=>({...a,email:e.target.value})))}}),"error"===m.email&&(0,t.jsx)(N.Z.Validation,{variant:m.email,children:"Your email is not valid."})]}),(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your first name"}),(0,t.jsx)(S.Z,{value:h.firstName,onChange:e=>{u((a=>({...a,firstName:e.target.value})))}}),"error"===m.firstName&&(0,t.jsx)(N.Z.Validation,{variant:m.firstName,children:"Your first name must have more than 1 character."})]}),(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your last name"}),(0,t.jsx)(S.Z,{value:h.lastName,onChange:e=>{u((a=>({...a,lastName:e.target.value})))}}),"error"===m.lastName&&(0,t.jsx)(N.Z.Validation,{variant:m.lastName,children:"Your last name must have more than 1 character."})]}),(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your password"}),(0,t.jsx)(S.Z,{type:"password",value:h.password,onChange:e=>{u((a=>({...a,password:e.target.value})))}}),"error"===m.password&&(0,t.jsx)(N.Z.Validation,{variant:m.password,children:"Your password is not valid."})]}),(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your password confirmation"}),(0,t.jsx)(S.Z,{type:"password",value:h.passwordConfirm,onChange:e=>{u((a=>({...a,passwordConfirm:e.target.value})))}}),"error"===m.passwordConfirm&&(0,t.jsx)(N.Z.Validation,{variant:m.passwordConfirm,children:"Your password confirmation is not valid."})]}),(0,t.jsx)(R.Z,{sx:{display:"flex"},mt:2,children:(0,t.jsx)(T.r,{variant:"primary",type:"submit",disabled:d||"success"!==m.handle||"success"!==m.email||"success"!==m.firstName||"success"!==m.lastName||"success"!==m.password||"success"!==m.passwordConfirm,onClick:async()=>{var e;d||((e=h).password===e.passwordConfirm||(o("Please make sure your passwords match.",{variant:"warning"}),0))&&(c(!0),s({url:`${r}/api/iam/v1/join/request/token`,method:"POST",body:{handle:h.handle,email:h.email,firstName:h.firstName,lastName:h.lastName,password:h.password,passwordConfirm:h.passwordConfirm}}).then((e=>{c(!1),e.success?(o(e.message,{variant:"success"}),n(a)):(o(e.message,{variant:"warning"}),e.errors.map((e=>o(e,{variant:"error"}))))})).catch((e=>{console.error(e),c(!1),o("Application Error.",{variant:"error"})})))},children:d?"Requesting...":"Request to join"})})]})})})]})},q=e=>{const{loginRoute:a}=e,{enqueueToast:r}=Z(),s=(0,v.s)();return(0,l.useEffect)((()=>{r("Welcome to Datalayer - Login with your username and password",{variant:"success"}),s(a)}),[]),(0,t.jsx)(t.Fragment,{})};var P=r(71363),U=r(5917),V=r(19893),D=r(62005),H=r(9851),I=r(86642),X=r(21780);const O=e=>{const{heading:a,homeRoute:r,joinRoute:s,passwordRoute:o,joinConfirmRoute:n,showEmailLogin:d=!0,showGitHubLogin:c=!0,showTokenLogin:h=!0}=e,{apiRequest:u}=(0,i.h)({loginRoute:r}),{iamServerURL:m,clearAuth:p,setAuth:x,socialLogin:j,addSocialLogin:w}=(0,k.ZP)(),{enqueueToast:g}=Z(),f=(0,v.s)(),[y,C]=(0,l.useState)(!1),[Y,E]=(0,l.useState)(0),[F,q]=(0,l.useState)({handle:void 0,password:void 0}),[H,I]=(0,l.useState)({handle:void 0,password:void 0});(0,l.useEffect)((()=>{const e=(0,X.Dt)();e?(E(1),$(m,e,p,x,f,r).catch((e=>{console.error("Failed to log in with token from cookie",e),g("Failed to check authentication",{variant:"error"})})).finally((()=>{E(-1)}))):E(-1)}),[m]);const O=e=>{"Enter"===e.key&&W()},W=async()=>{y||""!==H.handle||""!==H.password||(C(!0),u({url:`${m}/api/iam/v1/login`,method:"POST",body:{handle:F.handle,password:F.password}}).then((e=>{if(C(!1),e.success){I({handle:"",password:""});const a=e.token;x(a),f(r)}else I({handle:"",password:"Invalid credentials"}),console.warn(`Failed to log in: ${e.message}`,e.errors??"")})).catch((e=>{console.error(e),C(!1),g("Application Error.",{variant:"error"})})))};return(0,l.useEffect)((()=>{if(!j.github){const e=P.URLExt.join(P.PageConfig.getBaseUrl(),"jupyter_iam/oauth/callback"),a=document.cookie.match("\\b_xsrf=([^;]*)\\b"),r={provider:"github",callback_uri:e};a&&(r.nonce=a[1]),fetch(P.URLExt.join(m,"api/iam/v1/oauth/login")+P.URLExt.objectToQueryString(r)).then((async e=>{if(e.ok){const a=await e.json();if(a.success)return void w("github",a.loginURL)}throw Error("Failed to get the GitHub login URL from Datalayer IAM.")})).catch((e=>{console.error("Failed to fetch the GitHub login URL.",e)}))}}),[m,j,w]),(0,l.useEffect)((()=>{I({...H,handle:void 0===F.handle?void 0:A(F.handle,1)?"":"Your handle may not be empty.",password:void 0===F.password?void 0:A(F.password,1)?"":"Your password may not be empty."})}),[F]),(0,t.jsxs)(b.X,{containerWidth:"medium",padding:"normal",sx:{overflow:"visible",minHeight:"calc(100vh - 45px)"},children:[(0,t.jsx)(b.X.Header,{children:(0,t.jsx)(L.Z,{children:a||"Login to Datalayer"})}),(0,t.jsx)(b.X.Content,{children:Y<0?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(R.Z,{display:"grid",gridTemplateColumns:"1fr 20px 1fr",children:[d&&(0,t.jsxs)(R.Z,{sx:{label:{marginTop:2},paddingRight:"10%"},children:[(0,t.jsx)(R.Z,{mt:5,children:(0,t.jsxs)(N.Z,{required:!0,children:[(0,t.jsx)(N.Z.Label,{children:"Your handle"}),(0,t.jsx)(S.Z,{autoFocus:!0,placeholder:"Your handle",value:F.handle,onChange:e=>{q((a=>({...a,handle:e.target.value})))},onKeyDown:O}),H.handle&&(0,t.jsx)(N.Z.Validation,{variant:H.handle?"error":"success",children:H.handle})]})}),(0,t.jsx)(R.Z,{children:(0,t.jsxs)(N.Z,{required:!0,children:[(0,t.jsx)(N.Z.Label,{children:"Your password"}),(0,t.jsx)(S.Z,{placeholder:"Your password",type:"password",value:F.password,onChange:e=>{q((a=>({...a,password:e.target.value})))},onKeyDown:O}),H.password&&(0,t.jsx)(N.Z.Validation,{variant:H.password?"error":"success",children:H.password})]})}),(0,t.jsxs)(R.Z,{mt:5,children:[(0,t.jsx)(T.r,{variant:"primary",disabled:y||""!==H.handle||""!==H.password,onClick:W,children:y?"Login...":a?"Login with Datalayer":"Login"}),(0,t.jsx)(R.Z,{pt:6}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.Z,{href:"javascript:return false;",onClick:()=>{f(s)},children:"Don't have an account?"}),(0,t.jsx)(R.Z,{pt:3})]}),(0,t.jsx)(U.Z,{href:"javascript:return false;",onClick:()=>{f(o)},children:"Forgot password?"}),s&&n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.Z,{pt:3}),(0,t.jsx)(U.Z,{href:"javascript:return false;",onClick:()=>{f(n)},children:"Activate your account with a code"})]})]})]}),(0,t.jsxs)(R.Z,{display:"flex",flexDirection:"column",sx:{margin:"auto"},children:[c&&j.github&&(0,t.jsxs)(T.r,{variant:"primary",href:j.github,as:"a",style:{margin:"10px 0"},children:[(0,t.jsx)("i",{className:"fa fa-solid fa-github",style:{marginRight:"1rem"}}),"Login with GitHub"]}),h&&(0,t.jsx)(_,{homeRoute:r,style:{margin:"10px 0"}})]})]})}):Y?(0,t.jsxs)(R.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"40px"},children:[(0,t.jsx)(V.Z,{}),(0,t.jsx)(D.Z,{children:"Checking authentication..."})]}):null})]})};function _(e){const{homeRoute:a,style:r}=e,s=(0,v.s)(),{iamServerURL:o,clearAuth:n,setAuth:i}=(0,k.ZP)(),{enqueueToast:d}=Z(),[c,h]=(0,l.useState)(!1),[u,m]=(0,l.useState)(""),p=(0,l.useCallback)((()=>{$(o,u,n,i,s,a).catch((e=>{console.error("Failed to log in with token",e),d("Failed to log in with token",{variant:"error"})})).finally((()=>{h(!1)}))}),[u]),x=(0,l.useCallback)((e=>{m(e.target.value)}),[m]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.r,{style:r,onClick:()=>{h(!0)},children:"Login with token"}),c&&(0,t.jsx)(I.V,{title:"Enter the token",onClose:()=>{h(!1)},footerButtons:[{buttonType:"default",onClick:()=>{h(!1)},content:"Cancel"},{buttonType:"primary",onClick:p,content:"Login",autoFocus:!0}],children:(0,t.jsx)(R.Z,{as:"form",children:(0,t.jsxs)(N.Z,{required:!0,children:[(0,t.jsx)(N.Z.Label,{children:"Authentication token"}),(0,t.jsx)(H.ZP,{block:!0,value:u,onInput:x})]})})})]})}async function $(e,a,r,s,o,n){const i=await fetch(`${e}/api/iam/v1/login`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({token:a})});if(!i.ok)throw 401===i.status&&(console.log("Jupyter IAM has received a 401 return code."),r()),new Error(i.status.toString());{const{token:e}=await i.json();if(!e)throw new Error("Invalid token.");s(e),o(n)}}const W=e=>{const{homeRoute:a}=e,{clearAuth:r}=(0,k.ZP)(),s=(0,v.s)();return(0,l.useEffect)((()=>{r(),s(a)}),[]),(0,t.jsx)(t.Fragment,{})},J=e=>{const{loginRoute:a,passwordWelcomeRoute:r}=e,{iamServerURL:s}=(0,k.ZP)(),{apiRequest:o}=(0,i.h)(),n=(0,v.s)(),{enqueueToast:d}=Z(),[c,h]=(0,l.useState)(!1),[u,m]=(0,l.useState)({handle:void 0,token:void 0}),[p,x]=(0,l.useState)({handle:void 0,token:void 0});return(0,l.useEffect)((()=>{x({...p,handle:void 0===u.handle?void 0:A(u.handle,1)?"success":"error",token:void 0===u.token?void 0:A(u.token,1)?"success":"error"})}),[u]),(0,t.jsxs)(b.X,{containerWidth:"medium",padding:"normal",sx:{overflow:"visible",minHeight:"calc(100vh - 45px)"},children:[(0,t.jsx)(b.X.Header,{children:(0,t.jsx)(L.Z,{children:"Confirm your password"})}),(0,t.jsx)(b.X.Content,{children:(0,t.jsx)(R.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,t.jsxs)(R.Z,{sx:{label:{marginTop:2}},children:[(0,t.jsx)(R.Z,{children:(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your handle"}),(0,t.jsx)(S.Z,{autoFocus:!0,value:u.handle,onChange:e=>{m((a=>({...a,handle:e.target.value})))}}),"error"===p.handle&&(0,t.jsx)(N.Z.Validation,{variant:p.handle,children:"Your handle must have more than 1 character."})]})}),(0,t.jsx)(R.Z,{children:(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your activation code (check your mail)"}),(0,t.jsx)(S.Z,{type:"email",value:u.token,onChange:e=>{m((a=>({...a,token:e.target.value})))}}),"error"===p.token&&(0,t.jsx)(N.Z.Validation,{variant:p.token,children:"Your activation token is too small."})]})}),(0,t.jsx)(R.Z,{sx:{display:"flex"},mt:2,children:(0,t.jsx)(T.r,{variant:"primary",type:"submit",disabled:c||"success"!==p.handle||"success"!==p.token,onClick:async()=>{c||(h(!0),o({url:`${s}/api/iam/v1/password/confirm/${u.handle}/${u.token}`,method:"GET"}).then((e=>{e.success?n(r):(d(e.message,{variant:"error"}),n(a))})).catch((e=>{console.error(e),d("Application Error.",{variant:"error"}),n(a)})))},children:c?"Activating...":"Activate"})})]})})})]})},B=e=>{const{passwordConfirmRoute:a}=e,{iamServerURL:r}=(0,k.ZP)(),{apiRequest:s}=(0,i.h)(),o=(0,v.s)(),{enqueueToast:n}=Z(),[d,c]=(0,l.useState)(!1),[h,u]=(0,l.useState)({handle:void 0,password:void 0,passwordConfirm:void 0}),[m,p]=(0,l.useState)({handle:void 0,password:void 0,passwordConfirm:void 0});return(0,l.useEffect)((()=>{p({...m,handle:void 0===h.password?void 0:A(h.password,1)?"success":"error",password:void 0===h.password?void 0:A(h.password,5)?"success":"error",passwordConfirm:void 0===h.passwordConfirm?void 0:A(h.passwordConfirm,5)?"success":"error"})}),[h]),(0,t.jsxs)(b.X,{containerWidth:"medium",padding:"normal",sx:{overflow:"visible",minHeight:"calc(100vh - 45px)"},children:[(0,t.jsx)(b.X.Header,{children:(0,t.jsx)(L.Z,{children:"Change your password"})}),(0,t.jsx)(b.X.Content,{children:(0,t.jsxs)(R.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:[(0,t.jsxs)(R.Z,{sx:{label:{marginTop:2}},children:[(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your handle"}),(0,t.jsx)(S.Z,{autoFocus:!0,value:h.handle,onChange:e=>{u((a=>({...a,handle:e.target.value})))}}),"error"===m.handle&&(0,t.jsx)(N.Z.Validation,{variant:m.handle,children:"Your handle must have more than 1 character."})]}),(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your new pasword"}),(0,t.jsx)(S.Z,{type:"password",value:h.password,onChange:e=>{u((a=>({...a,password:e.target.value})))}}),"error"===m.password&&(0,t.jsx)(N.Z.Validation,{variant:m.password,children:"Your new password is not valid."})]}),(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(N.Z.Label,{children:"Your new password confirmation"}),(0,t.jsx)(S.Z,{type:"password",value:h.passwordConfirm,onChange:e=>{u((a=>({...a,passwordConfirm:e.target.value})))}}),"error"===m.passwordConfirm&&(0,t.jsx)(N.Z.Validation,{variant:m.passwordConfirm,children:"Your password confirmation is not valid."})]})]}),(0,t.jsx)(R.Z,{sx:{display:"flex"},mt:2,children:(0,t.jsx)(T.r,{variant:"primary",type:"submit",disabled:d||"success"!==m.handle||"success"!==m.password||"success"!==m.passwordConfirm,onClick:()=>{d||(h.password===h.passwordConfirm||(n("Please make sure your passwords match.",{variant:"warning"}),0))&&(c(!0),s({url:`${r}/api/iam/v1/password/token`,method:"POST",body:{handle:h.handle,password:h.password,passwordConfirm:h.passwordConfirm}}).then((e=>{c(!1),e.success?(n(e.message,{variant:"success"}),o(a)):(n(e.message,{variant:"error"}),e.errors.map((e=>n(e,{variant:"error"}))))})).catch((e=>{console.error(e),c(!1),n("Application Error.",{variant:"error"})})))},children:d?"Sending mail to change password...":"Request to change password"})})]})})]})},M=e=>{const{loginRoute:a}=e,{enqueueToast:r}=Z(),s=(0,v.s)();return(0,l.useEffect)((()=>{s(a),r("Welcome back to Datalayer - Login with your username and new password",{variant:"success"})}),[]),(0,t.jsx)(t.Fragment,{})}}}]);