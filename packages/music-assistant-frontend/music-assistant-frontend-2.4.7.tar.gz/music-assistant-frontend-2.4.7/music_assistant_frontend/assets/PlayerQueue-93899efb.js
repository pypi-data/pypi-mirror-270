import{y as Y,R as Z,ac as ee,r as w,c as U,L as l,o as te,N as c,ap as A,b as ue,w as le,A as r,H as D,q as e,D as a,S as y,Q as p,z as o,B as v,K as f,v as ae,F as ie,I as ne,E as k,J as h,M as x,a5 as oe,O as re}from"./index-9b822783.js";import{L as se}from"./ListviewItem-030e11e6.js";import{B as de,L as _,C as me}from"./Container-05be0da0.js";import{A as z}from"./Alert-112324b3.js";import{V as B}from"./VBadge-c9fb58c5.js";import{a as H,V as pe}from"./VTabs-56e03670.js";import{n as g,l as I,k as P}from"./forwardRefs-af0663a3.js";import{b as J,e as ve,d as b}from"./VMenu-8029677e.js";import{V as O,a as G}from"./VToolbar-79c684b4.js";import{V as ce}from"./VVirtualScroll-a3d1c1c9.js";import{V as fe}from"./VCard-0d72f9dd.js";import{V as _e}from"./VCardText-bc96863a.js";import{V as ye}from"./VDialog-a6f484ad.js";import"./VTooltip-5955b4ca.js";import"./VInput-c159036c.js";import"./VSlideGroup-d3ac8eca.js";/* empty css              */import"./VAlert-fddf489c.js";const ge=k("br",null,null,-1),be={key:0},Ne=Y({__name:"PlayerQueue",setup(qe){const{t:W}=Z(),L=ee(),M=w(0),d=w(),$=w(!1),V=w([]),q=w([]),T=U(()=>l.activePlayerQueue?q.value.slice(l.activePlayerQueue.current_index):[]),S=U(()=>l.activePlayerQueue?q.value.slice(0,l.activePlayerQueue.current_index):[]),X=U(()=>M.value==1?S.value:T.value);te(()=>{const t=c.subscribe_multi([A.QUEUE_UPDATED,A.QUEUE_ITEMS_UPDATED],i=>{var u;i.object_id==((u=l.activePlayerQueue)==null?void 0:u.queue_id)&&(i.event==A.QUEUE_ITEMS_UPDATED?N():K())});ue(t)});const N=async function(){l.activePlayerQueue?(q.value=[],await c.getPlayerQueueItems(l.activePlayerQueue.queue_id,t=>{q.value.push(...t)})):q.value=[]},R=function(t){d.value=t,$.value=!0},F=function(t){E(),L.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},C=function(t,i){var u,n,s,m,Q;E(),!(!t||!l.activePlayerQueue)&&(i=="play_now"?c.queueCommandPlayIndex((u=l.activePlayerQueue)==null?void 0:u.queue_id,t.queue_item_id):i=="move_next"?c.queueCommandMoveNext((n=l.activePlayerQueue)==null?void 0:n.queue_id,t.queue_item_id):i=="up"?c.queueCommandMoveUp((s=l.activePlayerQueue)==null?void 0:s.queue_id,t.queue_item_id):i=="down"?c.queueCommandMoveDown((m=l.activePlayerQueue)==null?void 0:m.queue_id,t.queue_item_id):i=="delete"&&c.queueCommandDelete((Q=l.activePlayerQueue)==null?void 0:Q.queue_id,t.queue_item_id))},K=function(){V.value=[{label:"settings.player_settings",labelArgs:[],action:()=>{L.push(`/settings/editplayer/${l.activePlayerQueue.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{c.queueCommandClear(l.activePlayerQueue.queue_id)},icon:"mdi-cancel"},{label:l.activePlayerQueue.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{c.queueCommandShuffleToggle(l.activePlayerQueue.queue_id)},icon:l.activePlayerQueue.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[W(`repeatmode.${l.activePlayerQueue.repeat_mode}`)],action:()=>{c.queueCommandRepeatToggle(l.activePlayerQueue.queue_id)},icon:l.activePlayerQueue.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"}]},E=function(){d.value=void 0,$.value=!1};return le(()=>l.activePlayerQueue,t=>{t&&(N(),K())},{immediate:!0}),(t,i)=>(r(),D("section",null,[e(O,{variant:"flat",color:"transparent",style:{height:"50px"}},{title:a(()=>{var u;return[y(p(t.$t("queue"))+" | "+p((u=o(l).selectedPlayer)==null?void 0:u.display_name)+" ",1),o(x)("bp6")?f("",!0):(r(),v(B,{key:0,color:"grey",content:T.value.length,inline:""},null,8,["content"]))]}),append:a(()=>[o(x)("bp6")?(r(),v(pe,{key:0,modelValue:M.value,"onUpdate:modelValue":i[0]||(i[0]=u=>M.value=u),"show-arrows":"",grow:""},{default:a(()=>[e(H,{value:0},{default:a(()=>[y(p(t.$t("queue_next_items"))+" ",1),e(B,{color:"grey",content:T.value.length,inline:""},null,8,["content"])]),_:1}),e(H,{value:1},{default:a(()=>[y(p(t.$t("queue_previous_items"))+" ",1),e(B,{color:"grey",content:S.value.length,inline:""},null,8,["content"])]),_:1})]),_:1},8,["modelValue"])):f("",!0),V.value&&V.value.length>0?(r(),v(ve,{key:1,location:"bottom end"},{activator:a(({props:u})=>[e(de,ae({icon:"",style:{right:"3px"}},u),{default:a(()=>[e(g,{icon:"mdi-dots-vertical"})]),_:2},1040)]),default:a(()=>[e(J,null,{default:a(()=>[(r(!0),D(ie,null,ne(V.value.filter(u=>u.hide!=!0),(u,n)=>(r(),v(_,{key:n,title:t.$t(u.label,u.labelArgs),disabled:u.disabled==!0,onClick:s=>u.action?u.action():""},{prepend:a(()=>[e(b,{icon:u.icon},null,8,["icon"])]),_:2},1032,["title","disabled","onClick"]))),128))]),_:1})]),_:1})):f("",!0)]),_:1}),e(me,null,{default:a(()=>{var u;return[o(l).activePlayerQueue&&((u=o(l).activePlayerQueue)==null?void 0:u.radio_source.length)>0?(r(),v(z,{key:0,icon:"mdi-radio-tower"},{default:a(()=>{var n,s,m,Q;return[k("b",null,p(t.$t("queue_radio_enabled")),1),ge,y(" "+p(t.$t("queue_radio_based_on",[t.$t((n=o(l).activePlayerQueue)==null?void 0:n.radio_source[0].media_type)]))+" ",1),k("b",null,[k("a",{onClick:i[1]||(i[1]=Ce=>{var j;return o(l).activePlayerQueue?F((j=o(l).activePlayerQueue)==null?void 0:j.radio_source[0]):""})},p((s=o(l).activePlayerQueue)==null?void 0:s.radio_source[0].name),1)]),((m=o(l).activePlayerQueue)==null?void 0:m.radio_source.length)>1?(r(),D("span",be," (+"+p(((Q=o(l).activePlayerQueue)==null?void 0:Q.radio_source.length)-1)+")",1)):f("",!0)]}),_:1})):f("",!0),e(ce,{height:66,items:X.value,style:{height:"100%"}},{default:a(({item:n})=>{var s;return[n.media_item?(r(),v(se,{key:n.queue_item_id,item:n.media_item||n,"show-disc-number":!1,"show-track-number":!1,"show-duration":!0,"show-library":!0,"show-menu":!0,"show-provider":!1,"show-album":!1,"show-checkboxes":!1,"is-selected":!1,"show-details":!1,"is-disabled":n.queue_item_id==((s=o(l).curQueueItem)==null?void 0:s.queue_item_id),ripple:"",onMenu:m=>R(n),onClick:m=>C(n,"play_now"),onContextmenu:h(m=>R(n),["right","prevent"])},{append:a(()=>[o(x)("bp1")?(r(),v(I,{key:0,variant:"plain",ripple:"",icon:"mdi-arrow-up",title:t.$t("queue_move_up"),onClick:[m=>o(c).queueCommandMoveUp(o(l).activePlayerQueue.queue_id,n.queue_item_id),i[2]||(i[2]=h(()=>{},["prevent"])),i[3]||(i[3]=h(()=>{},["stop"]))]},null,8,["title","onClick"])):f("",!0),e(I,{icon:"mdi-arrow-down",title:t.$t("queue_move_down"),onClick:h(m=>o(c).queueCommandMoveDown(o(l).activePlayerQueue.queue_id,n.queue_item_id),["prevent"])},null,8,["title","onClick"])]),_:2},1032,["item","is-disabled","onMenu","onClick","onContextmenu"])):(r(),v(_,{key:1},{title:a(()=>[y(p(n.name),1)]),_:2},1024))]}),_:1},8,["items"]),q.value.length==0?(r(),v(z,{key:1,type:"info"},{default:a(()=>[y(p(t.$t("no_content")),1)]),_:1})):f("",!0)]}),_:1}),e(ye,{modelValue:$.value,"onUpdate:modelValue":i[11]||(i[11]=u=>$.value=u),fullscreen:t.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:a(()=>[e(fe,null,{default:a(()=>[e(O,{sense:"",dark:"",color:"primary"},{default:a(()=>[e(I,{icon:"mdi-play-circle-outline"}),d.value?(r(),v(G,{key:0,style:{"padding-left":"10px"}},{default:a(()=>{var u;return[k("b",null,p(o(oe)(((u=d.value)==null?void 0:u.name)||"",t.$vuetify.display.mobile?20:150)),1)]}),_:1})):(r(),v(G,{key:1,style:{"padding-left":"10px"}},{default:a(()=>{var u;return[k("b",null,p(t.$t("settings")),1),y(" | "+p((u=o(l).activePlayerQueue)==null?void 0:u.display_name),1)]}),_:1})),e(I,{icon:"mdi-close",dark:"",onClick:i[4]||(i[4]=u=>E())})]),_:1}),d.value?(r(),v(_e,{key:0},{default:a(()=>[e(J,null,{default:a(()=>{var u,n;return[e(_,{title:t.$t("play_now"),onClick:i[5]||(i[5]=s=>C(d.value,"play_now"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("play_next"),onClick:i[6]||(i[6]=s=>C(d.value,"move_next"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_move_up"),onClick:i[7]||(i[7]=s=>C(d.value,"up"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_move_down"),onClick:i[8]||(i[8]=s=>C(d.value,"down"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_delete"),onClick:i[9]||(i[9]=s=>C(d.value,"delete"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),e(P),((n=(u=d.value)==null?void 0:u.media_item)==null?void 0:n.media_type)==o(re).TRACK?(r(),v(_,{key:0,title:t.$t("show_info"),onClick:i[10]||(i[10]=s=>{var m;return(m=d.value)!=null&&m.media_item?F(d.value.media_item):""})},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):f("",!0),e(P)]}),_:1})]),_:1})):f("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])]))}});export{Ne as default};
