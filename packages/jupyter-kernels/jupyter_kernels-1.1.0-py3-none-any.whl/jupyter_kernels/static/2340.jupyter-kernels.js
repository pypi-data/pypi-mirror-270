"use strict";(self.webpackChunk_datalayer_jupyter_kernels=self.webpackChunk_datalayer_jupyter_kernels||[]).push([[2340],{72340:(e,t,o)=>{o.r(t),o.d(t,{default:()=>q,fileUploadStatus:()=>$});var r=o(44041),n=o(92376),a=o(43838),i=o(27990),s=o(57355),l=o(83243),d=o(2245),c=o(22290),u=o(21488),m=o(67335),p=o(34160),h=o(71204),w=o(48425),f=o(58722),g=o(29246),b=o(54103),y=o(94257),_=o(87624),v=o(52714),F=o(39138),C=o(55466),x=o(68471),k=o(18168),P=o(75753),S=o(25711),I=o(46931),W=o(63070);const B="FileBrowser",T="@jupyterlab/filebrowser-extension:browser";var N;!function(e){e.copy="filebrowser:copy",e.copyDownloadLink="filebrowser:copy-download-link",e.cut="filebrowser:cut",e.del="filebrowser:delete",e.download="filebrowser:download",e.duplicate="filebrowser:duplicate",e.hideBrowser="filebrowser:hide-main",e.goToPath="filebrowser:go-to-path",e.goUp="filebrowser:go-up",e.openPath="filebrowser:open-path",e.openUrl="filebrowser:open-url",e.open="filebrowser:open",e.openBrowserTab="filebrowser:open-browser-tab",e.paste="filebrowser:paste",e.createNewDirectory="filebrowser:create-new-directory",e.createNewFile="filebrowser:create-new-file",e.createNewMarkdownFile="filebrowser:create-new-markdown-file",e.refresh="filebrowser:refresh",e.rename="filebrowser:rename",e.copyShareableLink="filebrowser:share-main",e.copyPath="filebrowser:copy-path",e.showBrowser="filebrowser:activate",e.shutdown="filebrowser:shutdown",e.toggleBrowser="filebrowser:toggle-main",e.toggleNavigateToCurrentDirectory="filebrowser:toggle-navigate-to-current-directory",e.toggleLastModified="filebrowser:toggle-last-modified",e.toggleShowFullPath="filebrowser:toggle-show-full-path",e.toggleFileSize="filebrowser:toggle-file-size",e.toggleSortNotebooksFirst="filebrowser:toggle-sort-notebooks-first",e.search="filebrowser:search",e.toggleHiddenFiles="filebrowser:toggle-hidden-files",e.toggleFileCheckboxes="filebrowser:toggle-file-checkboxes"}(N||(N={}));const O="filebrowser",L={id:T,description:"Set up the default file browser (commands, settings,...).",requires:[g.iH,g.Fz,k.gv],optional:[r.L,F.O,n.Q,d.WW],provides:g.$l,autoStart:!0,activate:async(e,t,o,r,n,a,i,s)=>{const l=t;n&&n.add(l,O);const d=w.PageConfig.getOption("preferredPath");d&&await l.model.cd(d),function(e,t,o,r,n,a){const i=r.load("jupyterlab"),{docRegistry:s,commands:l}=e,{tracker:d}=o;l.addCommand(N.del,{execute:()=>{const e=d.currentWidget;if(e)return e.delete()},icon:P.UF.bindprops({stylesheet:"menuItem"}),label:i.__("Delete"),mnemonic:0}),l.addCommand(N.copy,{execute:()=>{const e=d.currentWidget;if(e)return e.copy()},icon:P.UI.bindprops({stylesheet:"menuItem"}),label:i.__("Copy"),mnemonic:0}),l.addCommand(N.cut,{execute:()=>{const e=d.currentWidget;if(e)return e.cut()},icon:P.xi.bindprops({stylesheet:"menuItem"}),label:i.__("Cut")}),l.addCommand(N.duplicate,{execute:()=>{const e=d.currentWidget;if(e)return e.duplicate()},icon:P.UI.bindprops({stylesheet:"menuItem"}),label:i.__("Duplicate")}),l.addCommand(N.goToPath,{label:i.__("Update the file browser to display the provided `path`."),execute:async e=>{var n;const a=e.path||"",i=!(null!==(n=null==e?void 0:e.dontShowBrowser)&&void 0!==n&&n);try{if("directory"!==(await E.navigateToPath(a,t,o,r)).type&&i){const e=E.getBrowserForPath(a,t,o);if(e){e.clearSelectedItems();const t=a.split("/"),o=t[t.length-1];o&&await e.selectItemByName(o)}}}catch(e){console.warn(`${N.goToPath} failed to go to: ${a}`,e)}if(i)return l.execute(N.showBrowser,{path:a})}}),l.addCommand(N.goUp,{label:"go up",execute:async()=>{const e=E.getBrowserForPath("",t,o);if(!e)return;const{model:r}=e;await r.restored,e.goUp()}}),l.addCommand(N.openPath,{label:e=>e.path?i.__("Open %1",e.path):i.__("Open from Pathâ€¦"),caption:e=>e.path?i.__("Open %1",e.path):i.__("Open from path"),execute:async e=>{var r;let n;if(n=(null==e?void 0:e.path)?e.path:null!==(r=(await p.m.getText({label:i.__("Path"),placeholder:"/path/relative/to/jlab/root",title:i.__("Open Path"),okLabel:i.__("Open")})).value)&&void 0!==r?r:void 0,n)try{const r="/"!==n&&n.endsWith("/");r&&(n=n.slice(0,n.length-1));const a=E.getBrowserForPath(n,t,o),{services:i}=a.model.manager,s=await i.contents.get(n,{content:!1});if(r&&"directory"!==s.type)throw new Error(`Path ${n}/ is not a directory`);if(await l.execute(N.goToPath,{path:n,dontShowBrowser:e.dontShowBrowser}),"directory"===s.type)return;return l.execute("docmanager:open",{path:n})}catch(e){return e.response&&404===e.response.status&&(e.message=i.__("Could not find path: %1",n)),(0,h.UW)(i.__("Cannot open"),e)}}}),a&&a.addItem({command:N.openPath,category:i.__("File Operations")}),l.addCommand(N.open,{execute:e=>{const t=e.factory||void 0,o=d.currentWidget;if(!o)return;const{contents:r}=o.model.manager.services;return Promise.all(Array.from((0,I.UI)(o.selectedItems(),(e=>{if("directory"===e.type){const t=r.localPath(e.path);return o.model.cd(`/${t}`)}return l.execute("docmanager:open",{factory:t,path:e.path})}))))},icon:e=>{var t;const o=e.factory||void 0;if(o){const e=s.getFileType(o);return null===(t=null==e?void 0:e.icon)||void 0===t?void 0:t.bindprops({stylesheet:"menuItem"})}return P.vi.bindprops({stylesheet:"menuItem"})},label:e=>e.label||e.factory||i.__("Open"),mnemonic:0}),l.addCommand(N.paste,{execute:()=>{const e=d.currentWidget;if(e)return e.paste()},icon:P.bG.bindprops({stylesheet:"menuItem"}),label:i.__("Paste"),mnemonic:0}),l.addCommand(N.createNewDirectory,{execute:()=>{const e=d.currentWidget;if(e)return e.createNewDirectory()},icon:P._5.bindprops({stylesheet:"menuItem"}),label:i.__("New Folder")}),l.addCommand(N.createNewFile,{execute:()=>{const e=d.currentWidget;if(e)return e.createNewFile({ext:"txt"})},icon:P._6.bindprops({stylesheet:"menuItem"}),label:i.__("New File")}),l.addCommand(N.createNewMarkdownFile,{execute:()=>{const e=d.currentWidget;if(e)return e.createNewFile({ext:"md"})},icon:P.pl.bindprops({stylesheet:"menuItem"}),label:i.__("New Markdown File")}),l.addCommand(N.refresh,{execute:e=>{const t=d.currentWidget;if(t)return t.model.refresh()},icon:P.n9.bindprops({stylesheet:"menuItem"}),caption:i.__("Refresh the file browser."),label:i.__("Refresh File List")}),l.addCommand(N.rename,{execute:e=>{const t=d.currentWidget;if(t)return t.rename()},isVisible:()=>!!d.currentWidget&&1===Array.from(d.currentWidget.selectedItems()).length,icon:P.gR.bindprops({stylesheet:"menuItem"}),label:i.__("Rename"),mnemonic:0}),l.addCommand(N.copyPath,{execute:()=>{var e;const t=d.currentWidget;if(!t)return;const o=t.selectedItems().next();if(!o.done)if("true"===w.PageConfig.getOption("copyAbsolutePath")){const t=w.PathExt.joinWithLeadingSlash(null!==(e=w.PageConfig.getOption("serverRoot"))&&void 0!==e?e:"",o.value.path);u.T.copyToSystem(t)}else u.T.copyToSystem(o.value.path)},isVisible:()=>!!d.currentWidget&&1===Array.from(d.currentWidget.selectedItems()).length,icon:P.Rb.bindprops({stylesheet:"menuItem"}),label:i.__("Copy Path")}),l.addCommand(N.shutdown,{execute:()=>{const e=d.currentWidget;if(e)return e.shutdownKernels()},icon:P.Br.bindprops({stylesheet:"menuItem"}),label:i.__("Shut Down Kernel")}),l.addCommand(N.toggleLastModified,{label:i.__("Show Last Modified Column"),isToggled:()=>t.showLastModifiedColumn,execute:()=>{const e=!t.showLastModifiedColumn,o="showLastModifiedColumn";if(n)return n.set(T,o,e).catch((e=>{console.error(`Failed to set ${o} setting`)}))}}),l.addCommand(N.toggleShowFullPath,{label:i.__("Show Full Path"),isToggled:()=>t.showFullPath,execute:()=>{const e=!t.showFullPath,o="showFullPath";if(n)return n.set(T,o,e).catch((e=>{console.error(`Failed to set ${o} setting`)}))}}),l.addCommand(N.toggleSortNotebooksFirst,{label:i.__("Sort Notebooks Above Files"),isToggled:()=>t.sortNotebooksFirst,execute:()=>{const e=!t.sortNotebooksFirst,o="sortNotebooksFirst";if(n)return n.set(T,o,e).catch((e=>{console.error(`Failed to set ${o} setting`)}))}}),l.addCommand(N.toggleFileSize,{label:i.__("Show File Size Column"),isToggled:()=>t.showFileSizeColumn,execute:()=>{const e=!t.showFileSizeColumn,o="showFileSizeColumn";if(n)return n.set(T,o,e).catch((e=>{console.error(`Failed to set ${o} setting`)}))}}),l.addCommand(N.toggleHiddenFiles,{label:i.__("Show Hidden Files"),isToggled:()=>t.showHiddenFiles,isVisible:()=>"true"===w.PageConfig.getOption("allow_hidden_files"),execute:()=>{const e=!t.showHiddenFiles;if(n)return n.set(T,"showHiddenFiles",e).catch((e=>{console.error("Failed to set showHiddenFiles setting")}))}}),l.addCommand(N.toggleFileCheckboxes,{label:i.__("Show File Checkboxes"),isToggled:()=>t.showFileCheckboxes,execute:()=>{const e=!t.showFileCheckboxes;if(n)return n.set(T,"showFileCheckboxes",e).catch((e=>{console.error("Failed to set showFileCheckboxes setting")}))}}),l.addCommand(N.search,{label:i.__("Search on File Names"),execute:()=>alert("search")})}(e,l,o,r,a,s),Promise.all([e.restored,l.model.restored]).then((()=>{i&&l.model.pathChanged.connect(((e,t)=>{i(t.newValue)})),a&&a.load(T).then((e=>{const t={navigateToCurrentDirectory:!1,showLastModifiedColumn:!0,showFileSizeColumn:!1,showHiddenFiles:!1,showFileCheckboxes:!1,sortNotebooksFirst:!1,showFullPath:!1},o={filterDirectories:!0};function r(e){let r;for(r in t){const o=e.get(r).composite;t[r]=o,l[r]=o}const n=e.get("filterDirectories").composite;o.filterDirectories=n,l.model.filterDirectories=n}e.changed.connect(r),r(e)}))}))}},U={id:"@jupyterlab/filebrowser-extension:factory",description:"Provides the file browser factory.",provides:g.Fz,requires:[f.T,k.gv],optional:[C.IStateDB,a.p.IInfo],activate:async(e,t,o,r,n)=>{const a=new c.u({namespace:O});return{createFileBrowser:(e,i={})=>{var s;const l=new b.q6({translator:o,auto:null===(s=i.auto)||void 0===s||s,manager:t,driveName:i.driveName||"",refreshInterval:i.refreshInterval,refreshStandby:()=>n&&!n.isConnected||"when-hidden",state:null===i.state?void 0:i.state||r||void 0}),d=i.restore,c=new y.f({id:e,model:l,restore:d,translator:o});return a.add(c),c},tracker:a}}},j={id:"@jupyterlab/filebrowser-extension:default-file-browser",description:"Provides the default file browser",provides:g.iH,requires:[g.Fz],optional:[i.v5,s.T.ITreeResolver,l.r],activate:async(e,t,o,r,n)=>{const{commands:a}=e,i=t.createFileBrowser("filebrowser",{auto:!1,restore:!1});return E.restoreBrowser(i,a,o,r,e,n),i}},D={id:"@jupyterlab/filebrowser-extension:download",description:"Adds the download file commands. Disabling this plugin will NOT disable downloading files from the server, if the user enters the appropriate download URLs.",requires:[g.Fz,k.gv],autoStart:!0,activate:(e,t,o)=>{const r=o.load("jupyterlab"),{commands:n}=e,{tracker:a}=t;n.addCommand(N.download,{execute:()=>{const e=a.currentWidget;if(e)return e.download()},icon:P.aL.bindprops({stylesheet:"menuItem"}),label:r.__("Download")}),n.addCommand(N.copyDownloadLink,{execute:()=>{const e=a.currentWidget;if(e)return e.model.manager.services.contents.getDownloadUrl(e.selectedItems().next().value.path).then((e=>{u.T.copyToSystem(e)}))},isVisible:()=>!!a.currentWidget&&1===Array.from(a.currentWidget.selectedItems()).length,icon:P.UI.bindprops({stylesheet:"menuItem"}),label:r.__("Copy Download Link"),mnemonic:0})}},z={id:"@jupyterlab/filebrowser-extension:widget",description:"Adds the file browser to the application shell.",requires:[f.T,g.iH,g.Fz,F.O,d.RX,k.gv,l.r,g.$l],optional:[d.WW],autoStart:!0,activate:(e,t,o,r,n,a,i,s,l,d)=>{const{commands:c}=e,{tracker:u}=r,p=i.load("jupyterlab");o.node.setAttribute("role","region"),o.node.setAttribute("aria-label",p.__("File Browser Section")),o.title.icon=P.vi;const h=()=>{const t=(0,I.sE)(e.commands.keyBindings,(e=>e.command===N.toggleBrowser));if(t){const e=t.keys.map(W.H.formatKeystroke).join(", ");o.title.caption=p.__("File Browser (%1)",e)}else o.title.caption=p.__("File Browser")};h(),e.commands.keyBindingChanged.connect((()=>{h()})),a.addFactory(B,"uploader",(e=>new _.Q({model:e.model,translator:i}))),a.addFactory(B,"fileNameSearcher",(e=>{const t=(0,S.mb)({updateFilter:(t,o)=>{e.model.setFilter((e=>t(e.name.toLowerCase())))},useFuzzyFilter:!0,placeholder:p.__("Filter files by name"),forceRefresh:!0});return t.addClass("jp-FileBrowser-filterBox"),t})),(0,m.o)(o,(0,m._)(a,n,B,z.id,i)),s.add(o,"left",{rank:100,type:"File Browser"}),c.addCommand(N.toggleBrowser,{label:p.__("File Browser"),execute:()=>o.isHidden?c.execute(N.showBrowser,void 0):c.execute(N.hideBrowser,void 0)}),c.addCommand(N.showBrowser,{label:p.__("Open the file browser for the provided `path`."),execute:e=>{const t=e.path||"",n=E.getBrowserForPath(t,o,r);if(n)if(o!==n){const e=["left","right"];for(const t of e)for(const e of s.widgets(t))if(e.contains(n))return void s.activateById(e.id)}else s.activateById(o.id)}}),c.addCommand(N.hideBrowser,{label:p.__("Hide the file browser."),execute:()=>{const e=u.currentWidget;e&&!e.isHidden&&s.collapseLeft()}}),c.addCommand(N.toggleNavigateToCurrentDirectory,{label:p.__("Show Active File in File Browser"),isToggled:()=>o.navigateToCurrentDirectory,execute:()=>{const e=!o.navigateToCurrentDirectory;return n.set(T,"navigateToCurrentDirectory",e).catch((e=>{console.error("Failed to set navigateToCurrentDirectory setting")}))}}),d&&d.addItem({command:N.toggleNavigateToCurrentDirectory,category:p.__("File Operations")}),s.restored.then((e=>{e.fresh&&"single-document"!==s.mode&&c.execute(N.showBrowser,void 0)})),Promise.all([e.restored,o.model.restored]).then((()=>{s.currentChanged.connect((async(e,n)=>{if(o.navigateToCurrentDirectory&&n.newValue){const{newValue:e}=n,a=t.contextForWidget(e);if(a){const{path:e}=a;try{await E.navigateToPath(e,o,r,i)}catch(t){console.warn(`${N.goToPath} failed to open: ${e}`,t)}}}}))}))}},A={id:"@jupyterlab/filebrowser-extension:share-file",description:'Adds the "Copy Shareable Link" command; useful for JupyterHub deployment for example.',requires:[g.Fz,k.gv],autoStart:!0,activate:(e,t,o)=>{const r=o.load("jupyterlab"),{commands:n}=e,{tracker:a}=t;n.addCommand(N.copyShareableLink,{execute:()=>{const e=a.currentWidget,t=null==e?void 0:e.selectedItems().next();void 0===t||t.done||u.T.copyToSystem(w.PageConfig.getUrl({workspace:w.PageConfig.defaultWorkspace,treePath:t.value.path,toShare:!0}))},isVisible:()=>!!a.currentWidget&&1===Array.from(a.currentWidget.selectedItems()).length,icon:P.Nq.bindprops({stylesheet:"menuItem"}),label:r.__("Copy Shareable Link")})}},R={id:"@jupyterlab/filebrowser-extension:open-with",description:"Adds the open-with feature allowing an user to pick the non-preferred document viewer.",requires:[g.Fz],autoStart:!0,activate:(e,t)=>{const{docRegistry:o}=e,{tracker:r}=t;let n=[];e.contextMenu.opened.connect((function(e){var t,a;const i=null!==(a=null===(t=e.menu.items.find((e=>{var t;return"submenu"===e.type&&"jp-contextmenu-open-with"===(null===(t=e.submenu)||void 0===t?void 0:t.id)})))||void 0===t?void 0:t.submenu)&&void 0!==a?a:null;if(!i)return;n.forEach((e=>e.dispose())),n.length=0,i.clearItems();const s=r.currentWidget?E.OpenWith.intersection((0,I.UI)(r.currentWidget.selectedItems(),(e=>E.OpenWith.getFactories(o,e)))):new Set;n=[...s].map((e=>i.addItem({args:{factory:e.name,label:e.label||e.name},command:N.open})))}))}},H={id:"@jupyterlab/filebrowser-extension:open-browser-tab",description:"Adds the open-in-new-browser-tab features.",requires:[g.Fz,k.gv],autoStart:!0,activate:(e,t,o)=>{const{commands:r}=e,n=o.load("jupyterlab"),{tracker:a}=t;r.addCommand(N.openBrowserTab,{execute:e=>{const t=a.currentWidget;if(!t)return;const o=e.mode;return Promise.all(Array.from((0,I.UI)(t.selectedItems(),(e=>{if("single-document"!==o)return r.execute("docmanager:open-browser-tab",{path:e.path});{const t=w.PageConfig.getUrl({mode:"single-document",treePath:e.path}),o=window.open();if(!o)throw new Error("Failed to open new browser tab.");o.opener=null,o.location.href=t}}))))},icon:P.Ug.bindprops({stylesheet:"menuItem"}),label:e=>"single-document"===e.mode?n.__("Open in Simple Mode"):n.__("Open in New Browser Tab"),mnemonic:0})}},$={id:"@jupyterlab/filebrowser-extension:file-upload-status",description:"Adds a file upload status widget.",autoStart:!0,requires:[g.Fz,k.gv],optional:[x.WQ],activate:(e,t,o,r)=>{if(!r)return;const n=new v.X({tracker:t.tracker,translator:o});r.registerStatusItem("@jupyterlab/filebrowser-extension:file-upload-status",{item:n,align:"middle",isActive:()=>!!n.model&&n.model.items.length>0,activeStateChanged:n.model.stateChanged})}},M={id:"@jupyterlab/filebrowser-extension:open-url",description:'Adds the feature "Open files from remote URLs".',autoStart:!0,requires:[g.iH,k.gv],optional:[d.WW],activate:(e,t,o,r)=>{const{commands:n}=e,a=o.load("jupyterlab"),i=N.openUrl;n.addCommand(i,{label:e=>e.url?a.__("Open %1",e.url):a.__("Open from URLâ€¦"),caption:e=>e.url?a.__("Open %1",e.url):a.__("Open from URL"),execute:async e=>{var o,r,i;let s=null!==(o=null==e?void 0:e.url)&&void 0!==o?o:"";if(s||(s=null!==(r=(await p.m.getText({label:a.__("URL"),placeholder:"https://example.com/path/to/file",title:a.__("Open URL"),okLabel:a.__("Open")})).value)&&void 0!==r?r:void 0),!s)return;let l,d="";try{const e=await fetch(s);l=await e.blob(),d=null!==(i=e.headers.get("Content-Type"))&&void 0!==i?i:""}catch(e){return e.response&&200!==e.response.status&&(e.message=a.__("Could not open URL: %1",s)),(0,h.UW)(a.__("Cannot fetch"),e)}try{const e=w.PathExt.basename(s),o=new File([l],e,{type:d}),r=await t.model.upload(o);return n.execute("docmanager:open",{path:r.path})}catch(e){return(0,h.UW)(a._p("showErrorMessage","Upload Error"),e)}}}),r&&r.addItem({command:i,category:a.__("File Operations")})}},q=[U,j,L,A,$,D,z,R,H,M];var E;!function(e){let t;e.getBrowserForPath=function(e,t,o){const{tracker:r}=o,n=t.model.manager.services.contents.driveName(e);if(n){return r.find((e=>e.model.driveName===n))||void console.warn(`${N.goToPath} failed to find filebrowser for path: ${e}`)}return t},e.navigateToPath=async function(t,o,r,n){const a=n.load("jupyterlab"),i=e.getBrowserForPath(t,o,r);if(!i)throw new Error(a.__("No browser for path"));const{services:s}=i.model.manager,l=s.contents.localPath(t);await s.ready;const d=await s.contents.get(t,{content:!1}),{model:c}=i;return await c.restored,"directory"===d.type?await c.cd(`/${l}`):await c.cd(`/${w.PathExt.dirname(l)}`),d},e.restoreBrowser=async function(e,t,o,r,n,a){const i="jp-mod-restoring";if(e.addClass(i),!o)return await e.model.restore(e.id),await e.model.refresh(),void e.removeClass(i);const s=async()=>{o.routed.disconnect(s);const n=await(null==r?void 0:r.paths);(null==n?void 0:n.file)||(null==n?void 0:n.browser)?(await e.model.restore(e.id,!1),n.file&&await t.execute(N.openPath,{path:n.file,dontShowBrowser:!0}),n.browser&&await t.execute(N.openPath,{path:n.browser,dontShowBrowser:!0})):(await e.model.restore(e.id),await e.model.refresh()),e.removeClass(i),(null==a?void 0:a.isEmpty("main"))&&t.execute("launcher:create")};o.routed.connect(s)},function(e){e.getFactories=function(e,t){const o=e.preferredWidgetFactories(t.path),r=e.getWidgetFactory("notebook");return r&&"notebook"===t.type&&-1===o.indexOf(r)&&o.unshift(r),o},e.intersection=function(e){let t;for(const o of e){if(void 0===t){t=new Set(o);continue}if(0===t.size)return t;let e=new Set;for(const r of o)t.has(r)&&e.add(r);t=e}return null!=t?t:new Set}}(t=e.OpenWith||(e.OpenWith={}))}(E||(E={}))}}]);