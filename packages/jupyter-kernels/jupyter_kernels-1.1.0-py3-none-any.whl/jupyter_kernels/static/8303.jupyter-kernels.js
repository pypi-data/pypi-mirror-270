"use strict";(self.webpackChunk_datalayer_jupyter_kernels=self.webpackChunk_datalayer_jupyter_kernels||[]).push([[8303],{65267:(e,t,i)=>{i.d(t,{l:()=>d});var n=i(96734),s=i(3053),r=i(83331),a=i(51840);class o extends n.U{constructor(e,t,i){super(e,i),this.parser=t}get documentType(){return"markdown-viewer"}get isAlwaysActive(){return!0}get supportedOptions(){return["maximalDepth","numberingH1","numberHeaders"]}getHeadings(){const e=this.widget.context.model.toString(),t=s.tF(r.o3(e),{...this.configuration,baseNumbering:1});return Promise.resolve(t)}}class d extends a.w{constructor(e,t){super(e),this.parser=t}_createNew(e,t){const i=new o(e,this.parser,t);let n=new WeakMap;const a=(t,i)=>{if(i){const t=n.get(i);if(t){const i=e.content.node.getBoundingClientRect(),n=t.getBoundingClientRect();(n.top>i.bottom||n.bottom<i.top)&&t.scrollIntoView({block:"center"})}else console.warn("Heading element not found for heading",i,"in widget",e)}},d=()=>{this.parser&&(s.Zd(e.content.node),n=new WeakMap,i.headings.forEach((async t=>{var i;const a=await r.N4(this.parser,t.raw,t.level);if(!a)return;const o=`h${t.level}[id="${a}"]`;n.set(t,s.U9(e.content.node,o,null!==(i=t.prefix)&&void 0!==i?i:""))})))};return e.content.ready.then((()=>{d(),e.content.rendered.connect(d),i.activeHeadingChanged.connect(a),i.headingsChanged.connect(d),e.disposed.connect((()=>{e.content.rendered.disconnect(d),i.activeHeadingChanged.disconnect(a),i.headingsChanged.disconnect(d)}))})),i}}},42315:(e,t,i)=>{i.d(t,{A:()=>n});const n=new(i(47963).Token)("@jupyterlab/markdownviewer:IMarkdownViewerTracker","A widget tracker for markdown\n  document viewers. Use this if you want to iterate over and interact with rendered markdown documents.")},47590:(e,t,i)=>{i.d(t,{av:()=>g,n8:()=>p});var n=i(71204),s=i(48425),r=i(48860),a=i(71720),o=i(18168),d=i(47963),h=i(98209),c=i(92279);const l="text/markdown";class g extends c.$L{constructor(e){super(),this._config={...g.defaultConfig},this._fragment="",this._ready=new d.PromiseDelegate,this._isRendering=!1,this._renderRequested=!1,this._rendered=new h.Signal(this),this.context=e.context,this.translator=e.translator||o.Sr,this._trans=this.translator.load("jupyterlab"),this.renderer=e.renderer,this.node.tabIndex=0,this.addClass("jp-MarkdownViewer"),(this.layout=new c.Qb).addWidget(this.renderer),this.context.ready.then((async()=>{await this._render(),this._monitor=new s.ActivityMonitor({signal:this.context.model.contentChanged,timeout:this._config.renderTimeout}),this._monitor.activityStopped.connect(this.update,this),this._ready.resolve(void 0)}))}get ready(){return this._ready.promise}get rendered(){return this._rendered}setFragment(e){this._fragment=e,this.update()}setOption(e,t){if(this._config[e]===t)return;this._config[e]=t;const{style:i}=this.renderer.node;switch(e){case"fontFamily":i.setProperty("font-family",t);break;case"fontSize":i.setProperty("font-size",t?t+"px":null);break;case"hideFrontMatter":this.update();break;case"lineHeight":i.setProperty("line-height",t?t.toString():null);break;case"lineWidth":{const e=t?`calc(50% - ${t/2}ch)`:null;i.setProperty("padding-left",e),i.setProperty("padding-right",e);break}case"renderTimeout":this._monitor&&(this._monitor.timeout=t)}}dispose(){this.isDisposed||(this._monitor&&this._monitor.dispose(),this._monitor=null,super.dispose())}onUpdateRequest(e){this.context.isReady&&!this.isDisposed&&(this._render(),this._fragment="")}onActivateRequest(e){this.node.focus()}async _render(){if(this.isDisposed)return;if(this._isRendering)return void(this._renderRequested=!0);this._renderRequested=!1;const{context:e}=this,{model:t}=e,i=t.toString(),s={};s[l]=this._config.hideFrontMatter?_.removeFrontMatter(i):i;const r=new a.a({data:s,metadata:{fragment:this._fragment}});try{if(this._isRendering=!0,await this.renderer.renderModel(r),this._isRendering=!1,this._renderRequested)return this._render();this._rendered.emit()}catch(t){requestAnimationFrame((()=>{this.dispose()})),(0,n.UW)(this._trans.__("Renderer Failure: %1",e.path),t)}}}!function(e){e.defaultConfig={fontFamily:null,fontSize:null,lineHeight:null,lineWidth:null,hideFrontMatter:!0,renderTimeout:1e3}}(g||(g={}));class u extends r.Ry{setFragment(e){this.content.setFragment(e)}}class p extends r.GA{constructor(e){super(_.createRegistryOptions(e)),this._fileType=e.primaryFileType,this._rendermime=e.rendermime}createNewWidget(e){var t,i,n,s,r;const a=this._rendermime.clone({resolver:e.urlResolver}).createRenderer(l),o=new g({context:e,renderer:a});return o.title.icon=null===(t=this._fileType)||void 0===t?void 0:t.icon,o.title.iconClass=null!==(n=null===(i=this._fileType)||void 0===i?void 0:i.iconClass)&&void 0!==n?n:"",o.title.iconLabel=null!==(r=null===(s=this._fileType)||void 0===s?void 0:s.iconLabel)&&void 0!==r?r:"",o.title.caption=this.label,new u({content:o,context:e})}}var _;!function(e){e.createRegistryOptions=function(e){return{...e,readOnly:!0}},e.removeFrontMatter=function(e){const t=e.match(/^---\n[^]*?\n(---|...)\n/);if(!t)return e;const{length:i}=t[0];return e.slice(i)}}(_||(_={}))},51840:(e,t,i)=>{i.d(t,{w:()=>s});var n=i(48425);class s{constructor(e){this.tracker=e}isApplicable(e){return!!this.tracker.has(e)}createNew(e,t){const i=this._createNew(e,t),s=e.context,r=()=>{i.refresh().catch((e=>{console.error("Failed to update the table of contents.",e)}))},a=new n.ActivityMonitor({signal:s.model.contentChanged,timeout:1e3});a.activityStopped.connect(r);const o=()=>{i.title=n.PathExt.basename(s.localPath)};return s.pathChanged.connect(o),s.ready.then((()=>{o(),r()})).catch((e=>{console.error(`Failed to initiate headings for ${s.localPath}.`)})),e.disposed.connect((()=>{a.activityStopped.disconnect(r),s.pathChanged.disconnect(o)})),i}}},96734:(e,t,i)=>{i.d(t,{U:()=>d});var n,s=i(55616),r=i(47963),a=i(98209),o=i(80882);class d extends s.I_{constructor(e,t){super(),this.widget=e,this._activeHeading=null,this._activeHeadingChanged=new a.Signal(this),this._collapseChanged=new a.Signal(this),this._configuration=null!=t?t:{...o.o5.defaultConfig},this._headings=new Array,this._headingsChanged=new a.Signal(this),this._isActive=!1,this._isRefreshing=!1,this._needsRefreshing=!1}get activeHeading(){return this._activeHeading}get activeHeadingChanged(){return this._activeHeadingChanged}get collapseChanged(){return this._collapseChanged}get configuration(){return this._configuration}get headings(){return this._headings}get headingsChanged(){return this._headingsChanged}get isActive(){return this._isActive}set isActive(e){this._isActive=e,this._isActive&&!this.isAlwaysActive&&this.refresh().catch((e=>{console.error("Failed to refresh ToC model.",e)}))}get isAlwaysActive(){return!1}get supportedOptions(){return["maximalDepth"]}get title(){return this._title}set title(e){e!==this._title&&(this._title=e,this.stateChanged.emit())}async refresh(){if(this._isRefreshing)return this._needsRefreshing=!0,Promise.resolve();this._isRefreshing=!0;try{const e=await this.getHeadings();if(this._needsRefreshing)return this._needsRefreshing=!1,this._isRefreshing=!1,this.refresh();e&&!n.areHeadingsEqual(e,this._headings)&&(this._headings=e,this.stateChanged.emit(),this._headingsChanged.emit())}finally{this._isRefreshing=!1}}setActiveHeading(e,t=!0){this._activeHeading!==e&&(this._activeHeading=e,this.stateChanged.emit()),t&&this._activeHeadingChanged.emit(this._activeHeading)}setConfiguration(e){const t={...this._configuration,...e};r.JSONExt.deepEqual(this._configuration,t)||(this._configuration=t,this.refresh().catch((e=>{console.error("Failed to update the table of contents.",e)})))}toggleCollapse(e){var t,i;if(e.heading)e.heading.collapsed=null!==(t=e.collapsed)&&void 0!==t?t:!e.heading.collapsed,this.stateChanged.emit(),this._collapseChanged.emit(e.heading);else{const t=null!==(i=e.collapsed)&&void 0!==i?i:!this.headings.some((e=>{var t;return!(null!==(t=e.collapsed)&&void 0!==t&&t)}));this.headings.forEach((e=>e.collapsed=t)),this.stateChanged.emit(),this._collapseChanged.emit(null)}}}!function(e){e.areHeadingsEqual=function(e,t){if(e.length===t.length){for(let i=0;i<e.length;i++)if(e[i].level!==t[i].level||e[i].text!==t[i].text||e[i].prefix!==t[i].prefix)return!1;return!0}return!1}}(n||(n={}))}}]);